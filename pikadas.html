<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PikChips">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="PIKADAS - PikChips">
    
    <title>PIKADAS - PikChips</title>
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <link rel="icon" type="image/png" sizes="192x192" href="image/PikMenu.png">
    <link rel="apple-touch-icon" sizes="180x180" href="image/PikMenu.png">
    <link rel="manifest" href="manifest.json">
    
    <style>
        .dish-image {
            width: 100%;
            max-width: 500px;
            height: auto;
            border-radius: 15px;
            margin: 20px auto;
            display: block;
            box-shadow: 0 8px 20px rgba(0,0,0,0.5);
        }
        
        .dish-title {
            text-align: center;
            font-size: 2.5rem;
            color: #ffeb3b;
            margin: 20px 0;
        }
        
        .pikada-option-btn {
            background: #2a2a2a;
            border: 3px solid #444;
            border-radius: 15px;
            padding: 20px 30px;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 150px;
            text-align: center;
        }
        
        .pikada-option-btn:hover {
            border-color: #ff6b35;
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(255, 107, 53, 0.4);
        }
        
        .pikada-option-btn.selected {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            border-color: #ffeb3b;
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.6);
        }
        
        .option-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #ffeb3b;
            margin-bottom: 8px;
        }
        
        .pikada-option-btn.selected .option-title {
            color: #ffffff;
        }
        
        .option-price {
            font-size: 1.1rem;
            font-weight: 600;
            color: #ffffff;
        }
        
        .base-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: #ffeb3b;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 235, 59, 0.1);
            border-radius: 10px;
            text-align: center;
        }
        
        .build-plate-section {
            background: #1a1a1a;
            padding: 30px 20px;
            margin: 30px auto;
            max-width: 600px;
            border-radius: 15px;
            border: 3px solid #ff6b35;
        }
        
        .build-plate-section h3 {
            color: #ffeb3b;
            font-size: 1.5rem;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .selection-group {
            margin-top: 25px;
        }
        
        .selection-group h4 {
            color: #ffeb3b;
            font-size: 1.2rem;
            margin-bottom: 12px;
            text-align: center;
        }
        
        .option-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 12px;
        }
        
        .option-card {
            background: #2a2a2a;
            border: 2px solid #3a3a3a;
            border-radius: 10px;
            padding: 12px;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .option-card:hover {
            border-color: #ff6b35;
            transform: translateY(-3px);
        }
        
        .option-card.selected {
            border-color: #4caf50;
            background: rgba(76, 175, 80, 0.2);
        }
        
        .salsa-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        
        .option-chip {
            border-radius: 20px;
            padding: 8px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            border: 2px solid;
        }
        
        .protein-selector {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .protein-card {
            background: #2a2a2a;
            border: 2px solid #3a3a3a;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .protein-card:hover {
            border-color: #ff6b35;
            transform: translateY(-3px);
        }
        
        .protein-card.selected {
            border-color: #4caf50;
            background: rgba(76, 175, 80, 0.2);
        }
        
        .protein-card.selected.exceeded {
            border-color: #f44336;
            background: rgba(244, 67, 54, 0.2);
        }
        
        .option-card.selected.exceeded {
            border-color: #f44336;
            background: rgba(244, 67, 54, 0.2);
        }
        
        .protein-name {
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .protein-price {
            color: #ffeb3b;
            font-weight: 700;
        }
        
        .total-price-section {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            text-align: center;
        }
        
        .total-price-label {
            color: #ffffff;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .total-price-amount {
            font-size: 2.5rem;
            font-weight: 700;
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .order-button {
            background: #4caf50;
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-decoration: none;
        }
        
        .order-button:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
            color: white;
            text-decoration: none;
        }
        
        @media (max-width: 768px) {
            .pikada-option-btn {
                min-width: 120px;
                padding: 15px 20px;
            }
            
            .option-title {
                font-size: 1.1rem;
            }
            
            .option-price {
                font-size: 1rem;
            }
        }
        
        /* Fondo de p√°gina */
        body {
            background-image: url('image/fondo4.png') !important;
            background-size: cover !important;
            background-position: center center !important;
            background-attachment: fixed !important;
            background-repeat: no-repeat !important;
            position: relative !important;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            z-index: -1;
            pointer-events: none;
        }
        
        /* Transparencia para tarjetas - igual que pik-parrilla */
        html body .menu-content,
        body .menu-content,
        .menu-content {
            background: transparent !important;
            position: relative;
            z-index: 1;
        }
        
        html body .menu-grid,
        body .menu-grid,
        .menu-grid {
            background: transparent !important;
        }
        
        html body .menu-content .menu-grid .menu-item,
        html body .menu-content .menu-item,
        html body .menu-grid .menu-item,
        html body .menu-item,
        body .menu-content .menu-grid .menu-item,
        body .menu-content .menu-item,
        body .menu-grid .menu-item,
        body .menu-item,
        .menu-content .menu-grid .menu-item,
        .menu-content .menu-item,
        .menu-grid .menu-item,
        .menu-item {
            background: rgba(0, 0, 0, 0.2) !important;
            backdrop-filter: blur(5px) !important;
            -webkit-backdrop-filter: blur(5px) !important;
        }
        
        html body .menu-item .item-content,
        body .menu-item .item-content,
        .menu-item .item-content {
            background: transparent !important;
        }
        
        html body .menu-item .item-details,
        body .menu-item .item-details,
        .menu-item .item-details {
            background: transparent !important;
        }
        
        html body .menu-item .item-actions,
        body .menu-item .item-actions,
        .menu-item .item-actions {
            background: transparent !important;
        }
    </style>
</head>
<body>
    <!-- Back Navigation -->
    <div class="back-navigation">
        <a href="index.html" class="back-btn">
            <i class="fas fa-arrow-left"></i> Volver al Men√∫ Principal
        </a>
    </div>

    <!-- Category Header -->
    <header class="category-header">
        <div class="logo-container">
            <div class="logo">
                <img src="image/PikMenu.png" alt="PikChips Logo" class="logo-image" decoding="async" fetchpriority="high">
            </div>
            <div class="brand-text">
                <h1>PIKADAS</h1>
                <div class="tagline">Elige tu picada favorita</div>
            </div>
        </div>
    </header>

    <!-- Dish Details -->
    <main class="menu-content">
        <div class="dish-details">
            <img src="imageProductos/Picada.jpg" alt="PIKADAS" class="dish-image" id="pikada-image" loading="lazy" decoding="async">
            
            <h2 class="dish-title">PIKADAS</h2>
            
            <!-- Opciones de Pikada -->
            <div class="pikada-options" style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin: 20px 0;">
                <button class="pikada-option-btn" data-option="para2" data-price="51000" data-name="PIKADAS PARA 2" data-proteins="6" data-guarniciones="3" data-ensaladas="1" data-salsas="1" onclick="selectPikadaOption(this)">
                    <div class="option-title">PARA 2</div>
                    <div class="option-price">$51.000</div>
                </button>
                <button class="pikada-option-btn" data-option="para4" data-price="68000" data-name="PIKADAS PARA 4" data-proteins="9" data-guarniciones="3" data-ensaladas="2" data-salsas="1" onclick="selectPikadaOption(this)">
                    <div class="option-title">PARA 4</div>
                    <div class="option-price">$68.000</div>
                </button>
                <button class="pikada-option-btn" data-option="especial" data-price="115000" data-name="PIKADAS ESPECIAL" data-proteins="12" data-guarniciones="4" data-ensaladas="2" data-salsas="1" onclick="selectPikadaOption(this)">
                    <div class="option-title">ESPECIAL</div>
                    <div class="option-price">$115.000</div>
                </button>
            </div>
            
            <div class="base-price" id="base-price-display" style="display: none;">
                <div style="margin-bottom: 10px;">Consumir aqu√≠: <span id="base-price-amount">$0</span></div>
                <div style="color: #ffeb3b;">Para llevar: <span id="base-price-llevar">$0</span> + valor del domicilio</div>
            </div>
        </div>

        <!-- Build Your Plate Section (se muestra al seleccionar una opci√≥n) -->
        <div class="build-plate-section" id="build-plate-section" style="display: none;">
            <h3><i class="fas fa-magic"></i> Personaliza tu Pikada</h3>
            <p style="color: #cccccc; text-align: center; margin-bottom: 20px;" id="pikada-description">
                Selecciona tus opciones
            </p>
            
            <div class="selection-group">
                <h4><i class="fas fa-drumstick-bite"></i> Agrega Prote√≠nas Adicionales</h4>
                <p id="protein-info" style="color: #ffeb3b; text-align: center; font-size: 0.9rem; margin-bottom: 10px; font-weight: 600;">
                    <i class="fas fa-info-circle"></i> <span id="protein-included-text">-</span> incluidas. Las adicionales tienen costo seg√∫n la prote√≠na
                </p>
                <div class="protein-selector" id="protein-selector">
                    <!-- Prote√≠nas se cargar√°n con JavaScript -->
                </div>
            </div>
            <div class="selection-group">
                <h4><i class="fas fa-utensils"></i> Elige tus Guarniciones</h4>
                <p id="guarnicion-info" style="color: #ffeb3b; text-align: center; font-size: 0.9rem; margin-bottom: 10px; font-weight: 600;">
                    <i class="fas fa-info-circle"></i> <span id="guarnicion-included-text">-</span> incluidas. Las adicionales: +$8.000 c/u
                </p>
                <div class="option-list" id="guarnicion-selector"></div>
            </div>
            <div class="selection-group">
                <h4><i class="fas fa-leaf"></i> Elige tus Ensaladas</h4>
                <p id="ensalada-info" style="color: #ffeb3b; text-align: center; font-size: 0.9rem; margin-bottom: 10px; font-weight: 600;">
                    <i class="fas fa-info-circle"></i> <span id="ensalada-included-text">-</span> incluidas. Las adicionales: +$6.000 c/u
                </p>
                <div class="option-list" id="ensalada-selector"></div>
            </div>
            <div class="selection-group">
                <h4><i class="fas fa-pepper-hot"></i> Elige tus Salsas</h4>
                <div class="salsa-container" id="salsa-selector"></div>
            </div>
            
            
            <!-- Resumen de Selecci√≥n -->
            <div class="selection-summary" id="selection-summary" style="background: #2a2a2a; padding: 20px; border-radius: 15px; border: 2px solid #ff6b35; margin-top: 30px; margin-bottom: 20px;">
                <h3 style="color: #ffeb3b; margin-bottom: 15px; font-size: 1.3rem; text-align: center;">
                    <i class="fas fa-list-check" style="margin-right: 8px;"></i>Resumen de tu Pedido
                </h3>
                <div id="summary-content" style="color: #ffffff;">
                    <p style="margin: 10px 0;"><strong style="color: #ff6b35;">Pikada:</strong> <span id="summary-pikada">-</span></p>
                    <p style="margin: 10px 0;"><strong style="color: #ff6b35;">Prote√≠nas Adicionales:</strong> <span id="summary-proteins">Ninguna</span></p>
                    <p style="margin: 10px 0;"><strong style="color: #ff6b35;">Guarniciones:</strong> <span id="summary-guarniciones">-</span></p>
                    <p style="margin: 10px 0;"><strong style="color: #ff6b35;">Ensaladas:</strong> <span id="summary-ensaladas">-</span></p>
                    <p style="margin: 10px 0;"><strong style="color: #ff6b35;">Salsas:</strong> <span id="summary-salsas">Sin seleccionar</span></p>
                </div>
            </div>
            
            <div class="total-price-section">
                <div class="total-price-label">Costo de este plato:</div>
                <div class="total-price-amount" id="total-price">$0</div>
            </div>
            
            <a href="#" class="order-button" id="order-button" onclick="sendOrder(); return false;">
                <i class="fab fa-whatsapp"></i> Pedir domicilio
            </a>
        </div>
    </main>

    <!-- Contact Section -->
    <section class="contact-section">
        <div class="address">
            <h3>Direcci√≥n</h3>
            <a href="https://maps.app.goo.gl/ochgZSWpUc8TR35n7" target="_blank" style="text-decoration: none; color: inherit;">
                <p><i class="fas fa-map-marker-alt"></i> Calle 22 # 15-33 Barrio el Pajonal Caucasia - Antioquia</p>
            </a>
        </div>
        <div class="contact">
            <h3>Cont√°ctanos</h3>
            <div class="contact-icons">
                <a href="tel:+573218221222" class="contact-icon phone">
                    <i class="fas fa-phone"></i>
                </a>
                <a href="https://www.instagram.com/pikchips_/" class="contact-icon facebook">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="https://wa.me/+573218221222" class="contact-icon whatsapp">
                    <i class="fab fa-whatsapp"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 PikChips. Todos los derechos reservados.</p>
        <p>Emil Jim√©nez Ortiz - Desarrollador Web</p>
    </footer>

    <script src="script.js"></script>
    
    <script>
        // Datos de las opciones de pikada
        const pikadaOptions = {
            para2: {
                name: "PIKADAS PARA 2",
                price: 51000,
                proteins: 6,
                guarniciones: 3,
                ensaladas: 1,
                salsas: 1,
                image: "imageProductos/Picada-Para-2-Food.jpg"
            },
            para4: {
                name: "PIKADAS PARA 4",
                price: 68000,
                proteins: 9,
                guarniciones: 3,
                ensaladas: 2,
                salsas: 1,
                image: "imageProductos/Picada-Mixta-4-Personas.jpg"
            },
            especial: {
                name: "PIKADAS ESPECIAL",
                price: 115000,
                proteins: 12,
                guarniciones: 4,
                ensaladas: 2,
                salsas: 1,
                image: "imageProductos/Picada-Familiar-Food.jpg"
            }
        };
        
        // Prote√≠nas disponibles
        const proteins = [
            { name: "Chorizo", price: 6000 },
            { name: "Morcilla", price: 5000 },
            { name: "Pechitos", price: 7000 },
            { name: "Ranchera", price: 6000 },
            { name: "Tocineta", price: 5000 },
            { name: "Butifarra", price: 4000 },
            { name: "Alb√≥ndigas", price: 6000 },
            { name: "Chinchurria", price: 6000 },
            { name: "Desmechada de Res", price: 7000 },
            { name: "Desmechada de Pollo", price: 6000 },
            { name: "Chicharr√≥n Crocante", price: 7000 },
            { name: "Salchicha Premium Zen√∫", price: 5000 },
            { name: "Deditos de Pollo Apanado", price: 6000 },
            { name: "Trocitos de Queso Frito", price: 5000 },
            { name: "Trocitos de Res Asados", price: 7000 },
            { name: "Trocitos de Res Encebollados", price: 7000 },
            { name: "Trocitos de Pollo Asados", price: 6000 },
            { name: "Trocitos de Pollo Encebollados", price: 6000 },
            { name: "Trocitos de Cerdo Asados", price: 6000 },
            { name: "Trocitos de Cerdo Encebollados", price: 6000 }
        ];
        
        const guarniciones = [
            "Papa Cascos",
            "Papa Criolla",
            "Papa Francesa",
            "Huevo de Codorniz",
            "Arroz",
            "Yuca",
            "Patac√≥n",
            "Maicitos"
        ];
        
        const ensaladas = [
            "Sin ensalada",
            "Dulce",
            "Rusa",
            "Verde"
        ];
        
        const salsas = [
            "Tomate",
            "BBQ",
            "Pi√±a",
            "Ma√≠z",
            "Mostaza",
            "Miel Mostaza",
            "Mayonesa",
            "Guacamole",
            "Ajo",
            "Showy",
            "T√°rtara",
            "Rosada"
        ];
        
        // Colores para cada salsa
        const salsaColors = {
            "Tomate": { bg: "#dc2626", border: "#b91c1c", text: "#ffffff" },
            "BBQ": { bg: "#991b1b", border: "#7f1d1d", text: "#ffffff" },
            "Pi√±a": { bg: "#fbbf24", border: "#f59e0b", text: "#000000" },
            "Ma√≠z": { bg: "#fde047", border: "#facc15", text: "#000000" },
            "Mostaza": { bg: "#eab308", border: "#ca8a04", text: "#000000" },
            "Miel Mostaza": { bg: "#facc15", border: "#eab308", text: "#000000" },
            "Mayonesa": { bg: "#fef3c7", border: "#fde68a", text: "#000000" },
            "Guacamole": { bg: "#16a34a", border: "#15803d", text: "#ffffff" },
            "Ajo": { bg: "#f5f5f4", border: "#e7e5e4", text: "#000000" },
            "Showy": { bg: "#ef4444", border: "#dc2626", text: "#ffffff" },
            "T√°rtara": { bg: "#fef2f2", border: "#fee2e2", text: "#000000" },
            "Rosada": { bg: "#fda4af", border: "#fb7185", text: "#000000" }
        };
        
        // Estado actual
        let selectedPikada = null;
        let selectedProteins = [];
        let selectedGuarniciones = [];
        let selectedEnsaladas = [];
        let selectedSalsas = [];
        
        // Costos adicionales por servicio para llevar (SIEMPRE se aplican en WhatsApp)
        const LLEVAR_COSTOS = {
            para2: 3000,
            para4: 3000,
            especial: 6000
        };
        
        // Obtener costo adicional para llevar seg√∫n la pikada
        function getLlevarCosto() {
            if (!selectedPikada) return 0;
            if (selectedPikada.name === "PIKADAS PARA 2") {
                return LLEVAR_COSTOS.para2;
            } else if (selectedPikada.name === "PIKADAS PARA 4") {
                return LLEVAR_COSTOS.para4;
            } else if (selectedPikada.name === "PIKADAS ESPECIAL") {
                return LLEVAR_COSTOS.especial;
            }
            return 0;
        }
        
        // Seleccionar opci√≥n de pikada
        function selectPikadaOption(button) {
            // Remover selecci√≥n anterior de pikadas
            document.querySelectorAll('.pikada-options .pikada-option-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Seleccionar nueva opci√≥n
            button.classList.add('selected');
            
            const option = button.dataset.option;
            selectedPikada = pikadaOptions[option];
            
            // Mostrar precio base
            document.getElementById('base-price-display').style.display = 'block';
            document.getElementById('base-price-amount').textContent = `$${selectedPikada.price.toLocaleString()}`;
            
            // Mostrar secci√≥n de personalizaci√≥n
            document.getElementById('build-plate-section').style.display = 'block';
            
            // Actualizar descripci√≥n
            const description = `${selectedPikada.proteins} Prote√≠nas, ${selectedPikada.guarniciones} Guarniciones, ${selectedPikada.ensaladas} Ensalada(s), ${selectedPikada.salsas} Salsa(s)`;
            document.getElementById('pikada-description').textContent = description;
            
            // Actualizar informaci√≥n de precios adicionales
            document.getElementById('protein-included-text').textContent = `${selectedPikada.proteins} prote√≠nas`;
            document.getElementById('guarnicion-included-text').textContent = `${selectedPikada.guarniciones} guarniciones`;
            document.getElementById('ensalada-included-text').textContent = `${selectedPikada.ensaladas} ensalada(s)`;
            
            // Reiniciar selecciones
            selectedProteins = [];
            selectedGuarniciones = [];
            selectedEnsaladas = [];
            selectedSalsas = [];
            
            // Renderizar opciones
            renderProteins();
            renderGuarniciones();
            renderEnsaladas();
            renderSalsas();
            
            // Actualizar precios base (consumir aqu√≠ y para llevar)
            const precioConsumir = selectedPikada.price;
            const precioLlevar = selectedPikada.price + getLlevarCosto();
            document.getElementById('base-price-amount').textContent = `$${precioConsumir.toLocaleString()}`;
            document.getElementById('base-price-llevar').textContent = `$${precioLlevar.toLocaleString()}`;
            
            updateTotal();
            updateSummary();
            
            // Scroll suave a la secci√≥n de personalizaci√≥n
            document.getElementById('build-plate-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        // Actualizar precio del servicio para llevar
        function updateLlevarPrice() {
            if (!selectedPikada) {
                document.getElementById('llevar-price-badge').textContent = '(+$0)';
                return;
            }
            
            const llevarPriceEl = document.getElementById('llevar-price-badge');
            
            // Determinar el costo seg√∫n la pikada seleccionada
            let costoAdicional = 0;
            if (selectedPikada.name === "PIKADAS PARA 2") {
                costoAdicional = LLEVAR_COSTOS.para2;
            } else if (selectedPikada.name === "PIKADAS PARA 4") {
                costoAdicional = LLEVAR_COSTOS.para4;
            } else if (selectedPikada.name === "PIKADAS ESPECIAL") {
                costoAdicional = LLEVAR_COSTOS.especial;
            }
            
            if (costoAdicional > 0) {
                llevarPriceEl.textContent = `(+$${costoAdicional.toLocaleString()})`;
            } else {
                llevarPriceEl.textContent = '(+$0)';
            }
        }
        
        // Renderizar prote√≠nas
        function renderProteins() {
            const selector = document.getElementById('protein-selector');
            const includedProteins = selectedPikada ? parseInt(selectedPikada.proteins) : 0;
            
            selector.innerHTML = proteins.map(protein => {
                const proteinIndex = selectedProteins.findIndex(p => p.name === protein.name);
                const isSelected = proteinIndex > -1;
                const isExceeded = isSelected && proteinIndex >= includedProteins;
                const isIncluded = isSelected && proteinIndex < includedProteins;
                
                return `
                    <div class="protein-card ${isSelected ? (isExceeded ? 'selected exceeded' : 'selected') : ''}" 
                         onclick="toggleProtein('${protein.name}', ${protein.price})">
                        <div class="protein-name">${protein.name}</div>
                        <div class="protein-price">${isIncluded ? '<span style="color: #4caf50;">Incluida</span>' : isExceeded ? `<span style="color: #ffcdd2;">+$${protein.price.toLocaleString()}</span>` : `+$${protein.price.toLocaleString()}`}</div>
                    </div>
                `;
            }).join('');
        }
        
        // Toggle prote√≠na
        function toggleProtein(name, price) {
            const index = selectedProteins.findIndex(p => p.name === name);
            if (index > -1) {
                selectedProteins.splice(index, 1);
            } else {
                selectedProteins.push({ name, price });
            }
            renderProteins();
            updateTotal();
            updateSummary();
        }
        
        // Renderizar guarniciones
        function renderGuarniciones() {
            const container = document.getElementById('guarnicion-selector');
            const includedGuarniciones = selectedPikada ? parseInt(selectedPikada.guarniciones) : 0;
            
            container.innerHTML = guarniciones.map(item => {
                const itemIndex = selectedGuarniciones.indexOf(item);
                const isSelected = itemIndex > -1;
                const isExceeded = isSelected && itemIndex >= includedGuarniciones;
                const isIncluded = isSelected && itemIndex < includedGuarniciones;
                
                return `
                    <div class="option-card ${isSelected ? (isExceeded ? 'selected exceeded' : 'selected') : ''}" onclick="toggleGuarnicion('${item}')">
                        ${item}${isIncluded ? ' <span style="color: #4caf50; font-size: 0.8em;">(Incluida)</span>' : isExceeded ? ` <span style="color: #ffeb3b; font-size: 0.8em;">(+$${ADDITIONAL_GUARNICION_PRICE.toLocaleString()})</span>` : ''}
                    </div>
                `;
            }).join('');
        }
        
        // Toggle guarnici√≥n
        function toggleGuarnicion(name) {
            const index = selectedGuarniciones.indexOf(name);
            if (index > -1) {
                selectedGuarniciones.splice(index, 1);
            } else {
                selectedGuarniciones.push(name);
            }
            renderGuarniciones();
            updateTotal();
            updateSummary();
        }
        
        // Renderizar ensaladas
        function renderEnsaladas() {
            const container = document.getElementById('ensalada-selector');
            const includedEnsaladas = selectedPikada ? parseInt(selectedPikada.ensaladas) : 0;
            
            container.innerHTML = ensaladas.map(item => {
                const itemIndex = selectedEnsaladas.indexOf(item);
                const isSelected = itemIndex > -1;
                const isExceeded = isSelected && itemIndex >= includedEnsaladas;
                const isIncluded = isSelected && itemIndex < includedEnsaladas;
                
                return `
                    <div class="option-card ${isSelected ? (isExceeded ? 'selected exceeded' : 'selected') : ''}" onclick="toggleEnsalada('${item}')">
                        ${item}${isIncluded ? ' <span style="color: #4caf50; font-size: 0.8em;">(Incluida)</span>' : isExceeded ? ` <span style="color: #ffeb3b; font-size: 0.8em;">(+$${ADDITIONAL_ENSALADA_PRICE.toLocaleString()})</span>` : ''}
                    </div>
                `;
            }).join('');
        }
        
        // Toggle ensalada
        function toggleEnsalada(name) {
            const index = selectedEnsaladas.indexOf(name);
            if (index > -1) {
                selectedEnsaladas.splice(index, 1);
            } else {
                selectedEnsaladas.push(name);
            }
            renderEnsaladas();
            updateTotal();
            updateSummary();
        }
        
        // Renderizar salsas
        function renderSalsas() {
            const container = document.getElementById('salsa-selector');
            container.innerHTML = salsas.map(item => {
                const isSelected = selectedSalsas.includes(item);
                const colors = salsaColors[item] || { bg: "#2a2a2a", border: "#3a3a3a", text: "#ffffff" };
                return `
                    <div class="option-chip ${isSelected ? 'selected' : ''}" 
                         onclick="toggleSalsa('${item}')"
                         style="background: ${colors.bg}; border-color: ${colors.border}; color: ${colors.text}; ${isSelected ? 'opacity: 1; transform: scale(1.05); box-shadow: 0 4px 12px rgba(0,0,0,0.3); font-weight: 600;' : 'opacity: 0.7;'}">
                        ${item}
                    </div>
                `;
            }).join('');
        }
        
        // Toggle salsa
        function toggleSalsa(name) {
            const index = selectedSalsas.indexOf(name);
            if (index > -1) {
                selectedSalsas.splice(index, 1);
            } else {
                selectedSalsas.push(name);
            }
            renderSalsas();
            updateSummary();
        }
        
        // Calcular opciones adicionales (que exceden las incluidas)
        function getAdditionalItems() {
            if (!selectedPikada) return { proteins: 0, guarniciones: 0, ensaladas: 0, salsas: 0 };
            
            const includedProteins = parseInt(selectedPikada.proteins);
            const includedGuarniciones = parseInt(selectedPikada.guarniciones);
            const includedEnsaladas = parseInt(selectedPikada.ensaladas);
            const includedSalsas = parseInt(selectedPikada.salsas);
            
            const selectedProteinsCount = selectedProteins.length;
            const selectedGuarnicionesCount = selectedGuarniciones.length;
            const selectedEnsaladasCount = selectedEnsaladas.length;
            const selectedSalsasCount = selectedSalsas.length;
            
            return {
                proteins: Math.max(0, selectedProteinsCount - includedProteins),
                guarniciones: Math.max(0, selectedGuarnicionesCount - includedGuarniciones),
                ensaladas: Math.max(0, selectedEnsaladasCount - includedEnsaladas),
                salsas: Math.max(0, selectedSalsasCount - includedSalsas)
            };
        }
        
        // Precios de opciones adicionales
        const ADDITIONAL_GUARNICION_PRICE = 8000;
        const ADDITIONAL_ENSALADA_PRICE = 6000;
        
        // Actualizar total
        function updateTotal() {
            if (!selectedPikada) return;
            
            // Mostrar ambos precios: consumir aqu√≠ y para llevar
            const totalConsumir = calculateTotalConsumir();
            const totalLlevar = calculateTotalLlevar();
            
            document.getElementById('total-price').innerHTML = `
                <div style="margin-bottom: 8px;">Consumir aqu√≠: <strong>$${totalConsumir.toLocaleString()}</strong></div>
                <div style="color: #ffeb3b;"><i class="fas fa-box" style="margin-right: 8px;"></i><strong>$${totalLlevar.toLocaleString()}</strong> + valor del <i class="fas fa-motorcycle" style="margin-left: 5px;"></i></div>
            `;
        }
        
        // Actualizar resumen
        function updateSummary() {
            if (!selectedPikada) return;
            
            document.getElementById('summary-pikada').textContent = selectedPikada.name;
            
            const additional = getAdditionalItems();
            const includedProteins = parseInt(selectedPikada.proteins);
            const includedGuarniciones = parseInt(selectedPikada.guarniciones);
            const includedEnsaladas = parseInt(selectedPikada.ensaladas);
            const includedSalsas = parseInt(selectedPikada.salsas);
            
            // Prote√≠nas
            if (selectedProteins.length > 0) {
                let proteinsText = selectedProteins.map(p => p.name).join(', ');
                if (selectedProteins.length <= includedProteins) {
                    // Todas est√°n incluidas
                    proteinsText += `<br><span style="color: #4caf50; font-size: 0.9em;">(${selectedProteins.length}/${includedProteins} incluidas - Sin costo adicional)</span>`;
                } else {
                    // Hay adicionales
                    const additionalProteinsList = selectedProteins.slice(includedProteins);
                    const additionalCost = additionalProteinsList.reduce((sum, p) => sum + p.price, 0);
                    proteinsText += `<br><span style="color: #4caf50; font-size: 0.9em;">${includedProteins} incluidas</span>`;
                    proteinsText += `<br><span style="color: #ffeb3b; font-size: 0.9em;">${additional.proteins} adicionales: +$${additionalCost.toLocaleString()}</span>`;
                }
                document.getElementById('summary-proteins').innerHTML = proteinsText;
            } else {
                document.getElementById('summary-proteins').innerHTML = `<span style="color: #999;">0/${includedProteins} seleccionadas</span>`;
            }
            
            // Guarniciones
            if (selectedGuarniciones.length > 0) {
                let guarnicionesText = selectedGuarniciones.join(', ');
                if (selectedGuarniciones.length > includedGuarniciones) {
                    const additionalCost = additional.guarniciones * ADDITIONAL_GUARNICION_PRICE;
                    guarnicionesText += `<br><span style="color: #4caf50; font-size: 0.9em;">${includedGuarniciones} incluidas</span>`;
                    guarnicionesText += `<br><span style="color: #ffeb3b; font-size: 0.9em;">${additional.guarniciones} adicionales: +$${additionalCost.toLocaleString()}</span>`;
                    document.getElementById('summary-guarniciones').innerHTML = guarnicionesText;
                } else {
                    guarnicionesText += ` (${selectedGuarniciones.length}/${includedGuarniciones} incluidas - Sin costo adicional)`;
                    document.getElementById('summary-guarniciones').innerHTML = guarnicionesText;
                }
            } else {
                document.getElementById('summary-guarniciones').innerHTML = `<span style="color: #999;">0/${includedGuarniciones} seleccionadas</span>`;
            }
            
            // Ensaladas
            if (selectedEnsaladas.length > 0) {
                let ensaladasText = selectedEnsaladas.join(', ');
                if (selectedEnsaladas.length > includedEnsaladas) {
                    const additionalCost = additional.ensaladas * ADDITIONAL_ENSALADA_PRICE;
                    ensaladasText += `<br><span style="color: #4caf50; font-size: 0.9em;">${includedEnsaladas} incluidas</span>`;
                    ensaladasText += `<br><span style="color: #ffeb3b; font-size: 0.9em;">${additional.ensaladas} adicionales: +$${additionalCost.toLocaleString()}</span>`;
                    document.getElementById('summary-ensaladas').innerHTML = ensaladasText;
                } else {
                    ensaladasText += ` (${selectedEnsaladas.length}/${includedEnsaladas} incluidas - Sin costo adicional)`;
                    document.getElementById('summary-ensaladas').innerHTML = ensaladasText;
                }
            } else {
                document.getElementById('summary-ensaladas').innerHTML = `<span style="color: #999;">0/${includedEnsaladas} seleccionadas</span>`;
            }
            
            // Salsas
            if (selectedSalsas.length > 0) {
                let salsasText = selectedSalsas.join(', ');
                if (selectedSalsas.length > includedSalsas) {
                    salsasText += ` (${includedSalsas} incluidas, ${additional.salsas} adicionales)`;
                } else {
                    salsasText += ` (${selectedSalsas.length}/${includedSalsas} incluidas)`;
                }
                document.getElementById('summary-salsas').textContent = salsasText;
            } else {
                document.getElementById('summary-salsas').textContent = `0/${includedSalsas} seleccionadas`;
            }
        }
        
        // Calcular total para consumir aqu√≠ (sin costo adicional)
        function calculateTotalConsumir() {
            if (!selectedPikada) return 0;
            
            let total = selectedPikada.price;
            const additional = getAdditionalItems();
            
            // Cobrar las prote√≠nas adicionales (las que exceden las incluidas)
            if (additional.proteins > 0) {
                const additionalProteins = selectedProteins.slice(-additional.proteins);
                additionalProteins.forEach(protein => {
                    total += protein.price;
                });
            }
            
            // Cobrar las guarniciones adicionales
            if (additional.guarniciones > 0) {
                total += additional.guarniciones * ADDITIONAL_GUARNICION_PRICE;
            }
            
            // Cobrar las ensaladas adicionales
            if (additional.ensaladas > 0) {
                total += additional.ensaladas * ADDITIONAL_ENSALADA_PRICE;
            }
            
            return total;
        }
        
        // Calcular total para llevar (SIEMPRE incluye el costo adicional)
        function calculateTotalLlevar() {
            return calculateTotalConsumir() + getLlevarCosto();
        }
        
        // Enviar pedido
        function sendOrder() {
            if (!selectedPikada) {
                alert('Por favor selecciona una opci√≥n de Pikada primero');
                return;
            }
            
            const additional = getAdditionalItems();
            const includedProteins = parseInt(selectedPikada.proteins);
            const includedGuarniciones = parseInt(selectedPikada.guarniciones);
            const includedEnsaladas = parseInt(selectedPikada.ensaladas);
            const includedSalsas = parseInt(selectedPikada.salsas);
            
            // Calcular totales
            const costoAdicionalLlevar = getLlevarCosto();
            const totalLlevar = calculateTotalLlevar(); // SIEMPRE se usa este total en WhatsApp
            
            // Construir mensaje detallado
            let message = `üçΩÔ∏è *${selectedPikada.name}*\n\n`;
            
            // Precio base
            message += `üí∞ *Precio Base:* $${selectedPikada.price.toLocaleString()}\n`;
            message += `üì¶ *Incluye:* ${includedProteins} Prote√≠nas, ${includedGuarniciones} Guarniciones, ${includedEnsaladas} Ensalada(s), ${includedSalsas} Salsa(s)\n\n`;
            
            // Prote√≠nas detalladas
            message += `ü•© *PROTE√çNAS:*\n`;
            if (selectedProteins.length > 0) {
                selectedProteins.forEach((protein, index) => {
                    if (index < includedProteins) {
                        message += `   ‚úì ${protein.name} (Incluida)\n`;
                    } else {
                        message += `   ‚ûï ${protein.name} (+$${protein.price.toLocaleString()})\n`;
                    }
                });
                if (selectedProteins.length < includedProteins) {
                    message += `   ‚ö†Ô∏è ${selectedProteins.length}/${includedProteins} seleccionadas\n`;
                }
            } else {
                message += `   ‚ö†Ô∏è Ninguna seleccionada (0/${includedProteins})\n`;
            }
            
            // Calcular costo adicional de prote√≠nas
            let proteinAdditionalCost = 0;
            if (additional.proteins > 0) {
                const additionalProteins = selectedProteins.slice(-additional.proteins);
                proteinAdditionalCost = additionalProteins.reduce((sum, p) => sum + p.price, 0);
            }
            
            message += `\n`;
            
            // Guarniciones detalladas
            message += `üçü *GUARNICIONES:*\n`;
            if (selectedGuarniciones.length > 0) {
                selectedGuarniciones.forEach((guarnicion, index) => {
                    if (index < includedGuarniciones) {
                        message += `   ‚úì ${guarnicion} (Incluida)\n`;
                    } else {
                        message += `   ‚ûï ${guarnicion} (+$${ADDITIONAL_GUARNICION_PRICE.toLocaleString()})\n`;
                    }
                });
                if (selectedGuarniciones.length < includedGuarniciones) {
                    message += `   ‚ö†Ô∏è ${selectedGuarniciones.length}/${includedGuarniciones} seleccionadas\n`;
                }
            } else {
                message += `   ‚ö†Ô∏è Ninguna seleccionada (0/${includedGuarniciones})\n`;
            }
            
            // Calcular costo adicional de guarniciones
            const guarnicionAdditionalCost = additional.guarniciones * ADDITIONAL_GUARNICION_PRICE;
            
            message += `\n`;
            
            // Ensaladas detalladas
            message += `ü•ó *ENSALADAS:*\n`;
            if (selectedEnsaladas.length > 0) {
                selectedEnsaladas.forEach((ensalada, index) => {
                    if (index < includedEnsaladas) {
                        message += `   ‚úì ${ensalada} (Incluida)\n`;
                    } else {
                        message += `   ‚ûï ${ensalada} (+$${ADDITIONAL_ENSALADA_PRICE.toLocaleString()})\n`;
                    }
                });
                if (selectedEnsaladas.length < includedEnsaladas) {
                    message += `   ‚ö†Ô∏è ${selectedEnsaladas.length}/${includedEnsaladas} seleccionadas\n`;
                }
            } else {
                message += `   ‚ö†Ô∏è Ninguna seleccionada (0/${includedEnsaladas})\n`;
            }
            
            // Calcular costo adicional de ensaladas
            const ensaladaAdditionalCost = additional.ensaladas * ADDITIONAL_ENSALADA_PRICE;
            
            message += `\n`;
            
            // Salsas detalladas
            message += `üå∂Ô∏è *SALSAS:*\n`;
            if (selectedSalsas.length > 0) {
                selectedSalsas.forEach((salsa, index) => {
                    if (index < includedSalsas) {
                        message += `   ‚úì ${salsa} (Incluida)\n`;
                    } else {
                        message += `   ‚ûï ${salsa} (Adicional)\n`;
                    }
                });
                if (selectedSalsas.length < includedSalsas) {
                    message += `   ‚ö†Ô∏è ${selectedSalsas.length}/${includedSalsas} seleccionadas\n`;
                }
            } else {
                message += `   ‚ö†Ô∏è Ninguna seleccionada (0/${includedSalsas})\n`;
            }
            
            message += `\n`;
            message += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
            message += `üìä *DESGLOSE DE COSTOS:*\n\n`;
            message += `   Precio Base: $${selectedPikada.price.toLocaleString()}\n`;
            
            if (proteinAdditionalCost > 0) {
                message += `   Prote√≠nas Adicionales: +$${proteinAdditionalCost.toLocaleString()}\n`;
            }
            if (guarnicionAdditionalCost > 0) {
                message += `   Guarniciones Adicionales: +$${guarnicionAdditionalCost.toLocaleString()}\n`;
            }
            if (ensaladaAdditionalCost > 0) {
                message += `   Ensaladas Adicionales: +$${ensaladaAdditionalCost.toLocaleString()}\n`;
            }
            if (costoAdicionalLlevar > 0) {
                message += `   üì¶ Servicio de empaques: +$${costoAdicionalLlevar.toLocaleString()}\n`;
            }
            
            message += `\n`;
            message += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
            message += `üíµ *TOTAL: $${totalLlevar.toLocaleString()}*\n`;
            message += `\n`;
            message += `üöö *Incluye servicio de empaques*\n`;
            message += `üèçÔ∏è *+ Valor del domicilio*\n`;
            message += `\n`;
            message += `‚úÖ ¬°Deseo realizar este pedido!`;
            
            const whatsappUrl = `https://wa.me/+573218221222?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }
    </script>
</body>
</html>


